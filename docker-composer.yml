services:
  app:
    # Build the image from the current directory
    build:
      context: .
      dockerfile: Dockerfile

    # Name the container for easier finding
    container_name: laravel_app

    # Map port 8080 on the user's computer to port 80 in the container
    # User will access via http://localhost:8080
    ports:
      - "8080:80"

    # Persist data so it isn't lost when the container stops
    volumes:
      # Save the SQLite database file
      - ./database:/var/www/html/database
      # Save logs and uploaded files
      - ./storage:/var/www/html/storage

    # Environment variables for production
    environment:
      - APP_ENV=production
      - APP_DEBUG=false
      - DB_CONNECTION=sqlite
      - DB_DATABASE=/var/www/html/database/database.sqlite

    # Automatically restart if it crashes or on reboot
    restart: unless-stopped
